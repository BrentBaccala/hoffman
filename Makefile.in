
# Debugging
CFLAGS=-g -Wall -march=pentium-m -I ~/src/readline-5.0 -I /usr/include/libxml2 -DUSE_NALIMOV

# Debugging w/optimization
# CFLAGS=-g -O3 -I ~/src/readline-5.0 -I /usr/include/libxml2 -DUSE_NALIMOV

# Debugging w/optimization and profiling
# CFLAGS=-g -pg -O3 -I ~/src/readline-5.0 -I /usr/include/libxml2 -DUSE_NALIMOV

CPPFLAGS=$(CFLAGS)

hoffman: hoffman.o probe.o egtb.o
	gcc $(CFLAGS) -o hoffman $^ -L . -lreadline -lxml2 -lstdc++
	grep -Hn BREAKPOINT *.c | cut -d : -f 1-2 | sed 's/^/break /' > .gdbinit

%.htb: %.xml
	./hoffman -g -o $@ $<
	./hoffman -v -n Nalimov $@

# %.htb.gz: %.xml
#	./hoffman -g -o $*.htb $<
#	./hoffman -v -n Nalimov $*.htb
#	gzip $*.htb

%.gz: %
	gzip $<

kpk.htb.gz: kqk.htb.gz krk.htb.gz knk.htb.gz kbk.htb.gz

kqkq.htb.gz: kqk.htb.gz

kqkr.htb.gz: kqk.htb.gz krk.htb.gz
kqkn.htb.gz: kqk.htb.gz knk.htb.gz
kqkb.htb.gz: kqk.htb.gz kbk.htb.gz

kqkp.htb.gz: kqkq.htb.gz kqkr.htb.gz kqkn.htb.gz kqkb.htb.gz

krkr.htb.gz: krk.htb.gz
krkn.htb.gz: krk.htb.gz knk.htb.gz
krkb.htb.gz: krk.htb.gz kbk.htb.gz

krkp.htb.gz: kqkr.htb.gz krkr.htb.gz krkb.htb.gz krkn.htb.gz

kbkb.htb.gz: kbk.htb.gz
kbkn.htb.gz: kbk.htb.gz knk.htb.gz

kbkp.htb.gz: kqkb.htb.gz krkb.htb.gz kbkb.htb.gz kbkn.htb.gz

knkn.htb.gz: knk.htb.gz

knkp.htb.gz: kqkn.htb.gz krkn.htb.gz kbkn.htb.gz knkn.htb.gz

kpkp.htb.gz: kqkp.htb.gz krkp.htb.gz kbkp.htb.gz knkp.htb.gz

krpk.htb.gz: krk.htb.gz kpk.htb.gz kqrk.htb.gz krrk.htb.gz krnk.htb.gz krbk.htb.gz
